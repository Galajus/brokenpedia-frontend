<mat-tab-group class="restrict-width">

  <!--BUILD-->

  <mat-tab label="Build">
    <div *ngIf="buildNotFound" fxLayout="column" fxLayoutGap="10">
      <mat-card fxFill fxLayoutAlign="center center" class="mat-elevation-z6" style="padding: 8px">
        <mat-card-content>
          <h2>Buildu nie znaleziono bądź jest prywatny</h2>
        </mat-card-content>
      </mat-card>
    </div>
    <div class="restrict-width" *ngIf="!buildNotFound" fxLayout="column" fxLayoutGap="10" style="margin-bottom: 10px">
      <div *ngIf="databaseBuild" class="reactions" style="" fxLayoutGap="10">
        <div fxLayout="row">

          <button class="sample" mat-icon-button (click)="upvote()">
            <mat-icon >thumb_up</mat-icon>
          </button>
          <div class="sample">
            {{databaseBuild.liking.length}}
          </div>
        </div>
      </div>
      <div>
        <div fxLayout="row" fxFlexAlign="center center" fxLayoutGap="10">
          <div fxFlex="65">
            <mat-card fxFill fxLayoutAlign="center center" class="mat-elevation-z6" style="padding: 8px">
              <mat-card-content>
                <div fxFlex fxLayoutGap="10" fxLayoutAlign="center center" style="font-size: 14px">
                  <div fxLayout="column" fxLayoutGap="5">
                    <button *ngIf="!databaseBuild" #saveButton mat-raised-button (click)="saveOnServer()">{{'BUILD_CALCULATOR.SAVE' | translate}}</button>
                    <button *ngIf="databaseBuild && databaseBuild.profile.uuid === jwtService.getUuid()" #saveButton mat-raised-button (click)="updateOnServer()">Aktualizuj</button>
                  </div>

                  <mat-form-field appearance="outline" color="accent" *ngIf="!databaseBuild">
                    <mat-label>{{'BUILD_CALCULATOR.CHOOSE_PROFESSION' | translate}}</mat-label>
                    <mat-select [(ngModel)]="newClass" (selectionChange)="classUpdate($event.value)">
                      <mat-option value="BARBARIAN">{{'BUILD_CALCULATOR.PROFESSION.BARBARIAN' | translate}}</mat-option>
                      <mat-option value="FIRE_MAGE">{{'BUILD_CALCULATOR.PROFESSION.FIRE_MAGE' | translate}}</mat-option>
                      <mat-option value="ARCHER">{{'BUILD_CALCULATOR.PROFESSION.ARCHER' | translate}}</mat-option>
                      <mat-option value="SHEED">{{'BUILD_CALCULATOR.PROFESSION.SHEED' | translate}}</mat-option>
                      <mat-option value="VOODOO">{{'BUILD_CALCULATOR.PROFESSION.VOODOO' | translate}}</mat-option>
                      <mat-option value="KNIGHT">{{'BUILD_CALCULATOR.PROFESSION.KNIGHT' | translate}}</mat-option>
                      <mat-option value="DRUID">{{'BUILD_CALCULATOR.PROFESSION.DRUID' | translate}}</mat-option>
                    </mat-select>
                  </mat-form-field>



                  <mat-form-field hintLabel="{{'BUILD_CALCULATOR.CHARACTER_LEVEL_TIP' | translate}}" appearance="outline" color="accent" style="width: 150px !important" *ngIf="(databaseBuild && databaseBuild.profile.uuid === jwtService.getUuid()) || !databaseBuild">
                    <mat-label>{{'BUILD_CALCULATOR.CHARACTER_LEVEL' | translate}}</mat-label>
                    <input type="number" [min]="1" [max]="140" matInput [(ngModel)]="newLevel" (change)="levelUpdate()">
                  </mat-form-field>

                  <h1 *ngIf="databaseBuild && databaseBuild.profile.uuid !== jwtService.getUuid()">
                    <strong>{{getPrettyProfession(newClass)}}</strong> {{newLevel}} LVL <i>by </i> <strong>{{databaseBuild.profile.nickname}}</strong>
                  </h1>
                </div>
              </mat-card-content>
            </mat-card>

          </div>
          <div fxFlex="35">
            <mat-card fxFill fxLayoutAlign="center center" class="mat-elevation-z6" style="padding: 8px">
              <mat-card-content>
                <div>
                  <div *ngIf="!databaseBuild" fxLayout="column" fxLayoutGap="15" fxLayoutAlign="center center">
                    <mat-slide-toggle [(ngModel)]="resetOnLevelChange">{{'BUILD_CALCULATOR.CLEAR_SKILL_STAT' | translate}}</mat-slide-toggle>
                  </div>
                  <div fxLayout="row" fxLayoutGap="15" fxLayoutAlign="center center">
                    <div fxLayout="column" fxLayoutAlign="center center"><img class="points" src="../../../../assets/calculator/stats.png" alt="stats points"> <h3 class="blue"> {{remainingStatsPoints}}/{{statPoints}} </h3></div>
                    <div fxLayout="column" fxLayoutAlign="center center"><img class="points" src="../../../../assets/calculator/student.png" alt="student points"> <h3 class="yellow"> {{studentPoints}} </h3></div>
                    <div fxLayout="column" fxLayoutAlign="center center"><img class="points" src="../../../../assets/calculator/adept.png" alt="adept points"> <h3 class="orange"> {{adeptPoints}} </h3></div>
                    <div fxLayout="column" fxLayoutAlign="center center"><img class="points" src="../../../../assets/calculator/master.png" alt="master points"> <h3 class="red"> {{masterPoints}} </h3></div>
                  </div>
                </div>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>

      <div>
        <mat-card class="mat-elevation-z6" style="padding: 8px 14px">
          <mat-card-content>
            <div>
              <div fxLayout="row" fxLayoutAlign="center" fxLayoutGap="10">
                <div *ngFor="let skill of currentClassSkills">
                  <div>
                    <div [class]="getLevelStyle(skill.level)" matBadge="{{getPrettyLevel(skill.level)}}" matBadgeColor="warn" matBadgeSize="large" matBadgePosition="below after">
                      <img class="skillImg" [ngClass]="{ 'activeImg': (skill.image === activeSkillImageName) }" (click)="setCurrentActive(skill.image)" src="../../assets/skills/{{skill.image}}.png" alt="{{skill.image}}">
                    </div>
                  </div>

                  <div fxLayoutAlign="center" class="upgrade">
                    <img (click)="updateLevelById(false, skill.id); setCurrentActive(skill.image)" class="downgradeImg" src="../../../../assets/calculator/skilldown.png" alt="skill down">
                    <img (click)="updateLevelById(true, skill.id); setCurrentActive(skill.image)" class="upgradeImg" src="../../../../assets/calculator/skillup.png" alt="skill up">
                  </div>
                </div>
              </div>

            </div>

          </mat-card-content>
        </mat-card>
      </div>

      <div>
        <mat-card class="mat-elevation-z6" style="padding: 8px 14px">
          <mat-card-content>
            <div>
              <div fxLayout="row" fxLayoutAlign="center" fxLayoutGap="10">
                <div *ngFor="let skill of currentBasicSkills">
                  <div>
                    <div [class]="getLevelStyle(skill.level)" matBadge="{{getPrettyLevel(skill.level)}}" matBadgeSize="large" matBadgePosition="below after">
                      <img class="skillImg" [ngClass]="{ 'activeImg': (skill.image === activeSkillImageName) }" (click)="setCurrentActive(skill.image)" src="../../assets/skills/{{skill.image}}.png" alt="{{skill.image}}">
                    </div>
                  </div>

                  <div fxLayoutAlign="center" class="upgrade">
                    <img (click)="updateLevelById(false, skill.id); setCurrentActive(skill.image)" class="downgradeImg" src="../../../../assets/calculator/skilldown.png" alt="skill down">
                    <img (click)="updateLevelById(true, skill.id); setCurrentActive(skill.image)" class="upgradeImg" src="../../../../assets/calculator/skillup.png" alt="skill up">
                  </div>

                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>

      <div fxLayout="row" fxFlexAlign="center center" fxLayoutGap="10" style="height: 335px">
        <mat-card fxFlex="70" class="mat-elevation-z6" fxLayoutAlign="center center" style="padding: 8px">
          <mat-card-content>
            <div fxLayout="row" fxLayoutAlign="center" fxLayoutGap="2">
              <div *ngFor="let stat of currentStats" fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="4">
                <img class="points" src="assets/stats/{{stat.image}}.png" alt="{{stat.image}} points">
                <h3 *ngIf="stat.minLevel == 20" class="blue"> {{stat.level * 10}} </h3>
                <h3 *ngIf="stat.minLevel == 10" class="blue"> {{stat.level}} </h3>
                <button (click)="updateStatById(true, 1, stat.id)" mat-stroked-button color="disabled" class="iconButton upgradeStat"> +1 </button>
                <button (click)="updateStatById(true, 10, stat.id)" mat-stroked-button color="disabled" class="iconButton upgradeStat"> +10 </button>
                <div class="make-space"></div>
                <button (click)="updateStatById(false, 1, stat.id)" mat-stroked-button color="disabled" class="iconButton reduceStat"> -1 </button>
                <button (click)="updateStatById(false, 10, stat.id)" mat-stroked-button color="disabled" class="iconButton reduceStat"> -10 </button>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
        <mat-card fxFlex class="mat-elevation-z6" style="padding: 8px">
          <mat-card-content>
            <div *ngIf="activeSkill && activeSkill.skillBasics.length != 0" fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="1">
              <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="1">
                <div>
                  <h4 style="display: inline; font-weight: bold">{{'BUILD_CALCULATOR.SKILLS.' + activeSkill.name | uppercase | underscore | translate}}</h4>
                  <h5 style="display: inline"> (lvl: {{getRealRequiredLevel(isBasicSkill(activeSkill.id), activeSkill)}}+)</h5>
                </div>
                <h5 *ngIf="activeSkill.requirements">{{'BUILD_CALCULATOR.REQUIREMENTS' | translate}}: {{'SKILL_REQUIREMENTS.' + activeSkill.requirements | uppercase | underscore | translate}}</h5>
                <h5 *ngIf="activeSkill.formula">{{'BUILD_CALCULATOR.FORMULA' | translate}}: {{'SKILL_FORMULAS.' + activeSkill.formula | translate}}</h5>
              </div>
              <h5 class="pointer" (click)="openSkillLevelSelectDialog('100ms', '100ms')">{{'BUILD_CALCULATOR.LEVEL' | translate}}: {{getLevelString(activeSkill.level)}} <mat-icon class="select-icon">navigation</mat-icon></h5>
              <div *ngIf="activeSkill.level != 0" fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="1">
                <h5 *ngIf="getActiveSkillBasic(activeSkill.level).damage">{{'BUILD_CALCULATOR.DAMAGE' | translate}}: {{getActiveSkillBasic(activeSkill.level).damage}}%</h5>
                <h5 *ngIf="getActiveSkillBasic(activeSkill.level).hitChance">{{'BUILD_CALCULATOR.CHANCE_TO_HIT' | translate}}: {{getActiveSkillBasic(activeSkill.level).hitChance}}%</h5>
                <h5 *ngIf="getActiveSkillBasic(activeSkill.level).manaCost">{{'BUILD_CALCULATOR.MANA' | translate}}: {{getActiveSkillBasic(activeSkill.level).manaCost}}</h5>
                <h5 *ngIf="getActiveSkillBasic(activeSkill.level).staminaCost">{{'BUILD_CALCULATOR.STAMINA' | translate}}: {{getActiveSkillBasic(activeSkill.level).staminaCost}}</h5>
                <h5 *ngIf="getActiveSkillBasic(activeSkill.level).roundsTime">{{'BUILD_CALCULATOR.ROUNDS' | translate}}: {{getActiveSkillBasic(activeSkill.level).roundsTime}}</h5>
                <h5 *ngIf="getActiveSkillBasic(activeSkill.level).additionalEffectChance">{{'BUILD_CALCULATOR.ADDITIONAL_EFFECT_CHANCE' | translate}}: {{getActiveSkillBasic(activeSkill.level).additionalEffectChance}}%</h5>
                <h5 *ngIf="getActiveSkillBasic(activeSkill.level).specialEffectValue">{{printSpecialEffect(getActiveSkillBasic(activeSkill.level))}}</h5>
                <h5 *ngIf="getActiveSkillBasic(activeSkill.level).skillDifficulty"
                    matTooltip="
                                1PA = {{getRequiredWisdomForSkill(activeSkill.level, 1, getActiveSkillBasic(activeSkill.level).skillDifficulty)}}
                                2PA = {{getRequiredWisdomForSkill(activeSkill.level, 2, getActiveSkillBasic(activeSkill.level).skillDifficulty)}}
                                3PA = {{getRequiredWisdomForSkill(activeSkill.level, 3, getActiveSkillBasic(activeSkill.level).skillDifficulty)}}
                    ">
                  {{'BUILD_CALCULATOR.DIFFICULTY' | translate}}: {{'DIFFICULTIES.' + getActiveSkillBasic(activeSkill.level).skillDifficulty | translate}}
                </h5>
              </div>
              <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="1"
                   *ngIf="activeSkill?.level != 0 &&
                  (getActiveSkillBasic(activeSkill.level).skillPsychoEffects.length > 0 ||
                  getActiveSkillBasic(activeSkill.level).skillCustomEffects.length > 0 ||
                  getActiveSkillBasic(activeSkill.level).effectRoundsTime)">
                <h5>{{'BUILD_CALCULATOR.EFFECT' | translate}}:</h5>
                <h5 *ngFor="let psycho of getActiveSkillBasic(activeSkill.level).skillPsychoEffects">{{'PSYCHO_EFFECTS.' + psycho.psychoEffect | translate}}: {{printPsychoValue(psycho)}}</h5>
                <h5 *ngFor="let custom of getActiveSkillBasic(activeSkill.level).skillCustomEffects">{{'CUSTOM_EFFECTS.' + custom.description | uppercase | underscore | translate}}{{printCustomEffectValue(custom)}}</h5>
                <h5 *ngIf="getActiveSkillBasic(activeSkill.level).effectRoundsTime">{{'BUILD_CALCULATOR.ROUNDS' | translate}}: {{getActiveSkillBasic(activeSkill.level).effectRoundsTime}}</h5>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </mat-tab>

  <!--BUILD DESCRIPTION-->

  <mat-tab label="{{'BUILD_CALCULATOR.DESCRIPTION' | translate}}">
    <div *ngIf="buildNotFound" fxLayout="column" fxLayoutGap="10">
      <mat-card fxFill fxLayoutAlign="center center" class="mat-elevation-z6" style="padding: 8px">
        <mat-card-content>
          <h2>{{'BUILD_CALCULATOR.NOT_FOUND' | translate}}</h2>
        </mat-card-content>
      </mat-card>
    </div>

    <div *ngIf="!databaseBuild || (!buildNotFound && databaseBuild?.profile?.uuid === jwtService.getUuid())" fxLayout="column" fxLayoutGap="10" style="padding-bottom: 10px">
      <mat-card fxFill fxLayoutAlign="center center" class="mat-elevation-z6">
        <mat-card-content>
          <div fxLayoutGap="15" fxLayout="column" fxLayoutAlign="center center">
            <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="20">
              <div fxLayout="column" fxLayoutAlign="center center">
                <h3>{{'BUILD_CALCULATOR.BUILD_NAME' | translate}}</h3>
                <mat-form-field appearance="fill" color="accent" style="width: 300px">
                  <mat-label>{{'BUILD_CALCULATOR.BUILD_NAME' | translate}}</mat-label>
                  <input matInput #blName maxlength="30" [(ngModel)]="buildName" placeholder="Nazwa buildu">
                  <mat-hint align="end">{{blName.value.length}} / 30</mat-hint>
                </mat-form-field>
              </div>
            </div>
            <div fxLayout="column" fxLayoutAlign="center center">
              <h3>{{'BUILD_CALCULATOR.SHORT_DESCRIPTION' | translate}}</h3>
              <mat-form-field appearance="fill" color="accent" style="width: 800px">
                <mat-label>{{'BUILD_CALCULATOR.SHORT_DESCRIPTION' | translate}}</mat-label>
                <input matInput #blShortDesc maxlength="150" [(ngModel)]="shortDescription" placeholder="Skrócony opis buildu">
                <mat-hint align="end">{{blShortDesc.value.length}} / 150</mat-hint>
              </mat-form-field>
            </div>
            <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="15">
              <mat-slide-toggle [(ngModel)]="privateBuild">{{'BUILD_CALCULATOR.BUILD_PRIVACY' | translate}}</mat-slide-toggle>
              <mat-slide-toggle [(ngModel)]="pvpBuild">{{'BUILD_CALCULATOR.PVP_BUILD' | translate}}</mat-slide-toggle>
            </div>
            <div style="max-width: 800px">
              <h3>{{'BUILD_CALCULATOR.DESCRIPTION' | translate | uppercase}}</h3>
              <angular-editor [(ngModel)]="description" [config]="editorConfig"></angular-editor>
              <div style="text-align: end">{{description?.toString().length ? description?.toString().length : 0}} / 6000</div>
            </div>
            <div>
              <h3>{{'BUILD_CALCULATOR.RESULT' | translate}}</h3>
            </div>
            <div style="max-width: 800px; word-wrap: break-word;" fxFill [innerHTML]="description">
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
    <div *ngIf="databaseBuild && !buildNotFound && databaseBuild?.profile?.uuid !== jwtService.getUuid()" style="padding-bottom: 10px">
      <mat-card class="mat-elevation-z6">
        <mat-card-content fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="10">
          <h1>{{buildName}}</h1>
          <mat-divider></mat-divider>
          <h2>{{shortDescription}}</h2>
          <mat-divider></mat-divider>
          <div style="max-width: 800px; word-wrap: break-word;" fxFill [innerHTML]="description"></div>
        </mat-card-content>
      </mat-card>
    </div>
  </mat-tab>

  <!--BUILD COMMENTS-->

  <!--<mat-tab label="Społeczność">
    Content 3
  </mat-tab>-->
</mat-tab-group>


<!--
<div class="container">
  <div class="item">
    <div class="circle-content">1</div>
  </div>
  <div class="item">
    <div class="circle-content">2</div>
  </div>
  <div class="item">
    <div class="circle-content">3</div>
  </div>
  <div class="item">
    <div class="circle-content">4</div>
  </div>
  <div class="item">
    <div class="circle-content">5</div>
  </div>
  <div class="item">
    <div class="circle-content">6</div>
  </div>
  <div class="item">
    <div class="circle-content">7</div>
  </div>
  <div class="item">
    <div class="circle-content">8</div>
  </div>
  <div class="item">
    <div class="circle-content">9</div>
  </div>
  <div class="item">
    <div class="circle-content">10</div>
  </div>
  <div class="item">
    <div class="circle-content">11</div>
  </div>
  <div class="item">
    <div class="circle-content">12</div>
  </div>
</div>-->
